<?xml version="1.0" encoding="utf-8"?>
<?define Version="1.2.855.2" ?>
<?define Manufacturer="Digimezzo" ?>
<?define Product="Dopamine" ?>
<?define ProductCab="Dopamine.cab" ?>
<?define DowngradeMessage="A newer version of this application is already installed. If you are sure you want to downgrade, remove the existing installation via Programs and Features." ?>
<!--<?define License="Dopamine.License.rtf" ?>-->
<?define BannerBmp="Dopamine.BannerBmp.bmp" ?>
<?define DialogBmp="Dopamine.DialogBmp.bmp" ?>
<?define UpgradeCode="744d2eee-0923-4e96-9efd-1ee5f13db75b"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="$(var.Product)" Language="1033" Version="$(var.Version)" Manufacturer="$(var.Manufacturer)" UpgradeCode="$(var.UpgradeCode)">
    <!-- Packaging -->
    <!-- ========= -->
    <Package Description="$(var.Product)" Comments="$(var.Product)" InstallerVersion="200" Compressed="yes" />
    <Media Id="1" Cabinet="$(var.ProductCab)" EmbedCab="yes" />
    <MajorUpgrade AllowSameVersionUpgrades="yes" DowngradeErrorMessage="$(var.DowngradeMessage)" />
    <InstallExecuteSequence>
      <Custom Action="KillApplication" After="LaunchConditions"/>
    </InstallExecuteSequence>
    <!--<WixVariable Id="WixUILicenseRtf" Value="$(var.License)" />-->
    <WixVariable Id="WixUIBannerBmp" Value="$(var.BannerBmp)" />
    <WixVariable Id="WixUIDialogBmp" Value="$(var.DialogBmp)" />
    <!-- Icons -->
    <!-- ===== -->
    <!-- This just defines an icon that can be used anywhere else -->
    <Icon Id="REUSABLEICON" SourceFile="$(var.Product).exe" />
    <!-- Properties -->
    <!-- ========== -->
    <Property Id="WixShellExecTarget" Value="[#$(var.Product).exe]" />
    <Property Id="QtExecCmdLine" Value='"taskkill.exe" /f /im $(var.Product).exe'/>
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch $(var.Product)" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <!-- This adds an icon for Add/Remove Programs. The Value is the Id of the Icon defined above -->
    <Property Id="ARPPRODUCTICON" Value="REUSABLEICON" />
    <!-- Custom actions -->
    <!-- ============== -->
    <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />
    <CustomAction Id="KillApplication" BinaryKey="WixCA" DllEntry="CAQuietExec" Execute="immediate" Return="ignore"/>
    <!-- User interface -->
    <!-- ============== -->
    <UI>
      <UIRef Id="WixUI_InstallDir" />
      <!-- Skip licence dialog (next 2 lines) -->
      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="InstallDirDlg" Order="2">1</Publish>
      <Publish Dialog="InstallDirDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="2">1</Publish>
      <!-- Add option to launch application after install is finished -->
      <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
    </UI>
    <!-- Directory tree -->
    <!-- ============== -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <!-- Start Menu -->
      <Directory Id="ProgramMenuFolder" />
      <!-- Program Files -->
      <Directory Id="ProgramFilesFolder" Name="PFiles">
        <Directory Id="INSTALLFOLDER" Name="$(var.Product)">
          <Directory Id="X64FOLDER" Name="x64">
            <Component Id="X64CMP" DiskId="1" Guid="89332F0B-AF41-49AC-9B8D-D1E8AD9E50F1">
              <File Id="ESQLITEX64" Source="x64\esqlite3.dll" />
            </Component>
          </Directory>
          <Directory Id="X86FOLDER" Name="x86">
            <Component Id="X86CMP" DiskId="1" Guid="4A1279BA-C6C3-43D3-A1BB-EBA723DEF405">
              <File Id="ESQLITEX86" Source="x86\esqlite3.dll" />
            </Component>
          </Directory>
          <Directory Id="ICONSFOLDER" Name="Icons">
            <Component Id="ICONSCMP" DiskId="1" Guid="69CA5CE5-F8DF-45E3-A6A1-837785389740">
              <File Source="Icons\Dopamine.ico" />
              <File Source="Icons\Dopamine - White.ico" />
              <File Source="Icons\Dopamine.png" />
              <File Source="Icons\Dopamine - White.png" />
              <File Source="Icons\Flac.ico" />
              <File Source="Icons\Generic.ico" />
              <File Source="Icons\Legacy tray.ico" />
              <File Source="Icons\M3u.ico" />
              <File Source="Icons\M4a.ico" />
              <File Source="Icons\Mp3.ico" />
              <File Source="Icons\Ogg.ico" />
              <File Source="Icons\Tray.ico" />
              <File Source="Icons\Wav.ico" />
              <File Source="Icons\Wma.ico" />
              <File Source="Icons\Zpl.ico" />
            </Component>
          </Directory>
          <Directory Id="LANGUAGESFOLDER" Name="Languages">
            <Component Id="LANGUAGESCMP" DiskId="1" Guid="9226C125-A567-45E2-ADC8-95D5256BB8B7">
              <File Source="Languages\BG.xml" />
              <File Source="Languages\CS.xml" />
              <File Source="Languages\DA.xml" />
              <File Source="Languages\DU.xml" />
              <File Source="Languages\EL.xml" />
              <File Source="Languages\EN.xml" />
              <File Source="Languages\ES.xml" />
              <File Source="Languages\FR.xml" />
              <File Source="Languages\HU.xml" />
              <File Source="Languages\IT.xml" />
              <File Source="Languages\NL.xml" />
              <File Source="Languages\PL.xml" />
              <File Source="Languages\PT-BR.xml" />
              <File Source="Languages\PT-PT.xml" />
              <File Source="Languages\RU.xml" />
              <File Source="Languages\SV.xml" />
              <File Source="Languages\TR.xml" />
              <File Source="Languages\UK.xml" />
              <File Source="Languages\ZH-CN.xml" />
              <File Source="Languages\ZH-TW.xml" />
            </Component>
          </Directory>
          <!-- Licenses -->
          <Directory Id="LICENSESFOLDER" Name="Licenses">
            <Component Id="LICENSESCMP" DiskId="1" Guid="5ADDD4A8-E954-415A-806D-07AA324B64DC">
              <File Source="Licenses\CSCore.txt" />
              <File Source="Licenses\DotNetZip.txt" />
              <File Source="Licenses\Font Awesome.txt" />
              <File Source="Licenses\GongSolutions.WPF.DragDrop.txt" />
              <File Source="Licenses\NVorbis.txt" />
              <File Source="Licenses\Prism.txt" />
              <File Source="Licenses\SQLite-net.txt" />
              <File Source="Licenses\TagLib#.txt" />
              <File Source="Licenses\Unity.txt" />
              <File Source="Licenses\Unity.WCF.txt" />
              <File Source="Licenses\WiX.txt" />
              <File Source="Licenses\WPF Native Folder Browser.txt" />
              <File Source="Licenses\WPF Sound Visualization Library.txt" />
            </Component>
          </Directory>
          <!-- Equalizer -->
          <Directory Id="EQUALIZERFOLDER" Name="Equalizer">
            <Component Id="EQUALIZERCMP" DiskId="1" Guid="FF9E83AA-FEEF-4F34-B8DB-60EF19477587">
              <File Source="Equalizer\Classical.deq" />
              <File Source="Equalizer\Club.deq" />
              <File Source="Equalizer\Dance.deq" />
              <File Source="Equalizer\Full bass and treble.deq" />
              <File Source="Equalizer\Full bass.deq" />
              <File Source="Equalizer\Full treble.deq" />
              <File Source="Equalizer\Headphones.deq" />
              <File Source="Equalizer\Large hall.deq" />
              <File Source="Equalizer\Live.deq" />
              <File Source="Equalizer\Party.deq" />
              <File Source="Equalizer\Pop.deq" />
              <File Source="Equalizer\Reggae.deq" />
              <File Source="Equalizer\Rock.deq" />
              <File Source="Equalizer\Ska.deq" />
              <File Source="Equalizer\Soft rock.deq" />
              <File Source="Equalizer\Soft.deq" />
              <File Source="Equalizer\Techno.deq" />
            </Component>
          </Directory>
          <!-- Application -->
          <Component Id="MAINCMP" DiskId="1" Guid="9B925874-C592-453A-BCA8-4CF8D8E60511">
            <!-- Files -->
            <File Source="Dopamine.exe">
              <Shortcut Id="ExeShortcut" Directory="ProgramMenuFolder" Name="Dopamine" WorkingDirectory="INSTALLFOLDER" Icon="REUSABLEICON" IconIndex="0" />
            </File>
            <File Source="Dopamine.exe.config" />
            <File Source="License.txt" />
            <File Source="Changelog.txt" />
            <File Source="BaseSettings.xml" />
            <File Source="Microsoft.Practices.ServiceLocation.dll" />
            <File Source="Microsoft.Practices.Unity.Configuration.dll" />
            <File Source="Microsoft.Practices.Unity.dll" />
            <File Source="Microsoft.Practices.Unity.RegistrationByConvention.dll" />
            <File Source="Prism.dll" />
            <File Source="Prism.Unity.Wpf.dll" />
            <File Source="Prism.Wpf.dll" />
            <File Source="Dopamine.Common.dll" />
            <File Source="Dopamine.Icons.dll" />
            <File Source="Dopamine.CollectionModule.dll" />
            <File Source="Dopamine.ControlsModule.dll" />
            <File Source="Dopamine.FullPlayerModule.dll" />
            <File Source="Dopamine.InformationModule.dll" />
            <File Source="Dopamine.MiniPlayerModule.dll" />
            <File Source="Dopamine.OobeModule.dll" />
            <File Source="Dopamine.SettingsModule.dll" />
            <File Source="CSCore.dll" />
            <File Source="GongSolutions.WPF.DragDrop.dll" />
            <File Source="Ionic.Zip.dll" />
            <File Source="NVorbis.dll" />
            <File Source="policy.2.0.taglib-sharp.dll" />
            <File Source="Digimezzo.Utilities.dll" />
            <File Source="Digimezzo.WPFControls.dll" />
            <File Source="SQLite-net.dll" />
            <File Source="SQLitePCL.batteries.dll" />
            <File Source="SQLitePCL.raw.dll" />
            <File Source="SQLitePCLPlugin_esqlite3.dll" />
            <File Source="System.Windows.Interactivity.dll" />
            <File Source="taglib-sharp.dll" />
            <File Source="Unity.Wcf.dll" />
            <File Source="WPFFolderBrowser.dll" />
            <File Source="WPFSoundVisualizationLib.dll" />
            <!-- Registry -->
            <RegistryKey Root="HKCR" Key="Directory\Shell\PlayWithDopamine">
              <RegistryValue Type="string" Value="Play with Dopamine"/>
            </RegistryKey>
            <RegistryKey Root="HKCR" Key="Directory\Shell\PlayWithDopamine\command">
              <RegistryValue Type="string" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;"/>
            </RegistryKey>
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities" Name="ApplicationName" Value="Dopamine" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities" Name="ApplicationDescription" Value="Dopamine audio player" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".m3u" Value="Dopamine.m3u" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".zpl" Value="Dopamine.zpl" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".mp3" Value="Dopamine.mp3" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".ogg" Value="Dopamine.ogg" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".wma" Value="Dopamine.wma" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".flac" Value="Dopamine.flac" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Dopamine\Capabilities\FileAssociations" Name=".m4a" Value="Dopamine.m4a" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\RegisteredApplications" Name="Dopamine" Value="SOFTWARE\Dopamine\Capabilities" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Applications\Dopamine.exe" Name="FriendlyAppName" Value="Dopamine" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.m3u" Value="Dopamine m3u file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.m3u\DefaultIcon" Value="[ICONSFOLDER]M3u.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.m3u\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.zpl" Value="Dopamine zpl file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.zpl\DefaultIcon" Value="[ICONSFOLDER]Zpl.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.zpl\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.mp3" Value="Dopamine mp3 file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.mp3\DefaultIcon" Value="[ICONSFOLDER]Mp3.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.mp3\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.ogg" Value="Dopamine ogg file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.ogg\DefaultIcon" Value="[ICONSFOLDER]Ogg.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.ogg\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.wma" Value="Dopamine wma file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.wma\DefaultIcon" Value="[ICONSFOLDER]Wma.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.wma\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.flac" Value="Dopamine flac file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.flac\DefaultIcon" Value="[ICONSFOLDER]Flac.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.flac\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.m4a" Value="Dopamine m4a file" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.m4a\DefaultIcon" Value="[ICONSFOLDER]M4a.ico,0" Type="string" />
            <RegistryValue Root="HKLM" Key="SOFTWARE\Classes\Dopamine.m4a\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.m3u" Value="Dopamine m3u file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.m3u\DefaultIcon" Value="[ICONSFOLDER]M3u.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.m3u\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.zpl" Value="Dopamine zpl file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.zpl\DefaultIcon" Value="[ICONSFOLDER]Zpl.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.zpl\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.mp3" Value="Dopamine mp3 file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.mp3\DefaultIcon" Value="[ICONSFOLDER]Mp3.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.mp3\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.ogg" Value="Dopamine ogg file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.ogg\DefaultIcon" Value="[ICONSFOLDER]Ogg.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.ogg\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.wma" Value="Dopamine wma file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.wma\DefaultIcon" Value="[ICONSFOLDER]Wma.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.wma\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.flac" Value="Dopamine flac file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.flac\DefaultIcon" Value="[ICONSFOLDER]Flac.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.flac\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.m4a" Value="Dopamine m4a file" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.m4a\DefaultIcon" Value="[ICONSFOLDER]M4a.ico,0" Type="string" />
            <RegistryValue Root="HKCR" Key="SOFTWARE\Classes\Dopamine.m4a\shell\open\command" Value="&quot;[INSTALLFOLDER]Dopamine.exe&quot; &quot;%1&quot;" Type="string" />
          </Component>
        </Directory>
      </Directory>
    </Directory>
    <!-- Components to add -->
    <!-- ================= -->
    <Feature Id="DefaultFeature" Title="Main Feature" Level="1">
      <ComponentRef Id="ICONSCMP" />
      <ComponentRef Id="LANGUAGESCMP" />
      <ComponentRef Id="LICENSESCMP" />
      <ComponentRef Id="EQUALIZERCMP" />
      <ComponentRef Id="MAINCMP" />
      <ComponentRef Id="X64CMP" />
      <ComponentRef Id="X86CMP" />
    </Feature>
  </Product>
</Wix>